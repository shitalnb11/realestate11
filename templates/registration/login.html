{% extends 'base.html' %}
{% load static %}
{% block title %}Login - Real Estate{% endblock %}

{% block content %}

<style>
/* === LOGIN PAGE STYLING === */
body {
  background-color: #f8f9fa;
}

.login-wrapper {
  max-width: 950px;
  width: 100%;
  background: #fff;
  border-radius: 1rem;
  overflow: hidden;
  box-shadow: 0 8px 30px rgba(0,0,0,.1);
  display: flex;
  flex-wrap: wrap;
  margin: 5rem auto;
}

.login-left {
  flex: 1 1 50%;
  background: url("{% static 'img/Luxury-Real-Estate-Brands.jpg' %}") center/cover no-repeat;
  min-height: 380px;
  position: relative;
}

.left-overlay {
  position: absolute;
  inset: 0;
  background: rgba(0,0,0,0.4);
}

.left-content {
  position: absolute;
  bottom: 25px;
  left: 25px;
  right: 25px;
  color: #fff;
}

.login-right {
  flex: 1 1 50%;
  padding: 3rem 2.5rem;
  display: flex;
  flex-direction: column;
  justify-content: center;
}

.login-right h3 {
  font-weight: 700;
  color: #0d1c4b;
}

.form-control {
  border-radius: 2rem;
  padding-left: 2.5rem;
}

.btn-login {
  border-radius: 2rem;
  padding: .6rem 1.2rem;
  font-weight: 500;
}

/* Message animation */
.alert {
  animation: fadeInDown 0.4s ease;
}

@keyframes fadeInDown {
  from { opacity: 0; transform: translateY(-10px); }
  to { opacity: 1; transform: translateY(0); }
}

/* Password eye icon */
.eye-icon {
  position: absolute;
  top: 50%;
  right: 15px;
  transform: translateY(-50%);
  cursor: pointer;
  color: #6c757d;
}

/* Responsive */
@media (max-width: 768px) {
  .login-left {
    flex: 1 1 100%;
    min-height: 200px;
  }
  .login-right {
    flex: 1 1 100%;
    padding: 2rem 1.5rem;
  }
}
</style>

<div class="main-container">
  <div class="login-wrapper">
    <!-- LEFT -->
    <div class="login-left">
      <div class="left-overlay"></div>
      <div class="left-content">
        <span class="badge bg-light text-dark mb-2">Real Nest</span>
        <h5>Manage Properties Efficiently</h5>
        <p>Gain the best experience with buying, selling, and renting properties in one platform.</p>
      </div>
    </div>

    <!-- RIGHT -->
    <div class="login-right">
      <h3 class="mt-2">Welcome Back to Real Nest!</h3>
      <p class="text-muted mb-4">Sign in to your account</p>

      <!-- ✅ Django Messages (Success/Error) -->
      {% if messages %}
        {% for message in messages %}
          <div 
            class="alert 
              {% if message.tags == 'success' %}alert-success
              {% elif message.tags == 'error' %}alert-danger
              {% elif message.tags == 'warning' %}alert-warning
              {% else %}alert-info{% endif %}
              alert-dismissible fade show text-center shadow-sm mx-auto mt-2"
            style="max-width: 500px; border-radius: 10px;"
            role="alert">
            <i class="bi 
              {% if message.tags == 'success' %}bi-check-circle-fill text-success
              {% elif message.tags == 'error' %}bi-x-circle-fill text-danger
              {% elif message.tags == 'warning' %}bi-exclamation-triangle-fill text-warning
              {% else %}bi-info-circle-fill text-info{% endif %}
              me-2"></i>
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
          </div>
        {% endfor %}
      {% endif %}

      <!-- ✅ Login Form -->
      <form method="post" action="{% url 'login' %}" class="needs-validation" novalidate>
        {% csrf_token %}

        <!-- Username -->
        <div class="mb-3 position-relative">
          <span class="input-icon"><i class="bi bi-envelope"></i></span>
          <input type="text" name="username" class="form-control" placeholder="Your Email or Username" required>
          <div class="invalid-feedback">Please enter a valid email or username.</div>
        </div>

        <!-- Password -->
        <div class="mb-2 position-relative">
          <span class="input-icon"><i class="bi bi-lock"></i></span>
          <input type="password" name="password" id="password" class="form-control" placeholder="Password" minlength="6" required>
          <span class="eye-icon" id="togglePass"><i class="bi bi-eye"></i></span>
          <div class="invalid-feedback">Please enter your password (min 6 characters).</div>
        </div>

        <div class="d-flex justify-content-between align-items-center mb-3">
          <div class="form-check small-link">
            <input class="form-check-input" type="checkbox" id="remember">
            <label class="form-check-label" for="remember">Remember Me</label>
          </div>
          <a href="{% url 'password_reset' %}">Forgot Password?</a>
        </div>

        <button class="btn btn-primary w-100 btn-login" type="submit">Login</button>

        <div class="text-center mt-3 small-link">
          Don’t have an account? <a href="{% url 'register' %}">Register</a>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- ✅ Password Toggle Script -->
<script>
  document.getElementById("togglePass").addEventListener("click", function() {
    const pass = document.getElementById("password");
    if (pass.type === "password") {
      pass.type = "text";
      this.innerHTML = '<i class="bi bi-eye-slash"></i>';
    } else {
      pass.type = "password";
      this.innerHTML = '<i class="bi bi-eye"></i>';
    }
  });
</script>

{% endblock %}
