{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Register </title>

  <!-- Bootstrap CSS + Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
<link rel="icon" type="image/png" sizes="32x32" href="{% static 'img/COMPANY22.PNG' %}">
  <!-- Custom CSS -->
  <!-- <link rel="stylesheet" href="{% static 'css/login.css' %}"> -->
  <style>
    /* Force navbar full width */
 .navbar {
  width: 100% !important;
  left: 0;
  right: 0;
  margin: 0;
  padding: 0.5rem 1rem;
  position: fixed;
  top: 0;
  z-index: 1030; 
 }
/* === MAIN WRAPPER === */
.register-wrapper {
  max-width: 950px;
  width: 100%;
  background: #fff;
  border-radius: 1rem;
  overflow: hidden;
  box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
  display: flex;
  flex-wrap: wrap;
  margin: 40px auto;
  margin-top: 100px;
}

/* === LEFT SIDE === */
.register-left {
  flex: 1 1 50%;
  background: url("/static/img/r1.webp") center/cover no-repeat;
  min-height: 380px;
  position: relative;
}

.left-overlay {
  position: absolute;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
}

.left-content {
  position: absolute;
  bottom: 25px;
  left: 25px;
  right: 25px;
  color: #fff;
}

.left-content h5 {
  font-weight: 600;
  margin-bottom: 8px;
}

.left-content p {
  font-size: 0.95rem;
  line-height: 1.5;
}

/* === RIGHT SIDE === */
.register-right {
  flex: 1 1 50%;
  padding: 3rem 2.5rem;
  display: flex;
  flex-direction: column;
  justify-content: center;
}

.register-right h3 {
  font-weight: 700;
  color: #0d1c4b;
}

.register-right p {
  margin-bottom: 1.5rem;
}

/* === INPUT + ICON ALIGNMENT === */
.position-relative {
  position: relative;
}

/* --- Input Icons --- */
.input-icon,
.eye-icon {
  position: absolute;
  top: 0;
  bottom: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  color: #6c757d;
  font-size: 1rem;
  pointer-events: none;
}

.input-icon {
  left: 15px;
}

.eye-icon {
  right: 15px;
  cursor: pointer;
  pointer-events: auto;
}

/* Fine-tuning for all browsers */
.input-icon i,
.eye-icon i {
  position: relative;
  top: 0; /* if still looks 1px low, try top:-1px */
}

/* === INPUT STYLING === */
.form-control {
  height: 45px;
  line-height: normal;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 2.5rem;
  padding-right: 2.5rem;
  display: flex;
  align-items: center;
  border-radius: 2rem;
  border: 1px solid #ced4da;
  transition: all 0.2s ease;
}

.was-validated .form-control:invalid,
.form-control.is-invalid,
.was-validated .form-control:valid,
.form-control.is-valid {
  height: 45px !important;
  line-height: normal !important;
  padding-top: 0 !important;
  padding-bottom: 0 !important;
}
/* === INPUT FOCUS === */
.form-control:focus {
  border-color: #198754;
  box-shadow: 0 0 0 0.15rem rgba(25, 135, 84, 0.15);
}

/* === ICON COLOR FEEDBACK === */
.form-control.is-invalid ~ .input-icon i {
  color: #dc3545; /* red for invalid */
}

.form-control.is-valid ~ .input-icon i {
  color: #198754; /* green for valid */
}

/* === BUTTON STYLING === */
.btn-register {
  border-radius: 2rem;
  padding: 0.6rem 1.2rem;
  font-weight: 500;
  background-color: #198754;
  border: none;
  transition: 0.3s ease;
}

.btn-register:hover {
  background-color: #157347;
}

/* === INVALID FEEDBACK === */
.invalid-feedback {
  font-size: 13px;
  color: #dc3545;
  margin-top: 5px;
  display: block;
  text-align: left;
  min-height: 20px; /* ✅ prevents jump */
}

/* Maintain consistent spacing between fields */
.mb-3.position-relative {
  margin-bottom: 1.9rem;
}

/* === FORM VALIDATION STATES === */
.was-validated .form-control:invalid,
.form-control.is-invalid {
  border-color: #dc3545;
  box-shadow: 0 0 0 0.15rem rgba(220, 53, 69, 0.1);
}

.was-validated .form-control:valid,
.form-control.is-valid {
  border-color: #198754;
  box-shadow: 0 0 0 0.15rem rgba(25, 135, 84, 0.1);
}

/* === SHAKE ANIMATION ON INVALID === */
@keyframes shake {
  0%, 100% { transform: translateX(0); }
  20%, 60% { transform: translateX(-4px); }
  40%, 80% { transform: translateX(4px); }
}

.form-control.is-invalid {
  animation: shake 0.2s ease-in-out;
}

/* === LINK STYLING === */
.small-link {
  font-size: 0.9rem;
  margin-top: 10px;
}

.small-link a {
  color: #0d6efd;
  text-decoration: none;
}

.small-link a:hover {
  text-decoration: underline;
}

/* === SUCCESS & ERROR MESSAGES === */
.text-success {
  font-weight: 500;
}

.text-danger {
  font-weight: 500;
}

/* === RESPONSIVE === */
@media (max-width: 768px) {
  .register-left {
    flex: 1 1 100%;
    min-height: 200px;
  }
  .register-right {
    flex: 1 1 100%;
    padding: 2rem 1.5rem;
  }
}

@media (max-width: 480px) {
  .register-wrapper {
    border-radius: 0;
    box-shadow: none;
  }

  .register-right {
    padding: 1.8rem 1rem;
  }

  .form-control {
    height: 42px;
  }
}


  </style>
</head>
<body>
<!-- ✅ Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
        <!-- <div class="container-fluid"> -->
            <a class="navbar-brand" href="{% url 'home' %}">
                <img src="{% static 'img/COMPANY22.PNG' %}"  alt="Delegent Properties" height="40" />
            </a>

            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link active" href="{% url 'home' %}">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="{% url 'properties' %}">Properties</a></li>
                    <li class="nav-item"><a class="nav-link" href="{% url 'contact' %}">Contact</a></li>
                     <li class="nav-item "><a class="nav-link " href="{% url 'register' %}">Register</a></li> 
                    {% if user.is_authenticated %}
  <form action="{% url 'logout' %}" method="post" style="display:inline;">
      {% csrf_token %}
      <button type="submit" class="btn btn-link nav-link" style="color:white; text-decoration:none;">Logout</button>
  </form>
{% else %}
  <!-- <li class="nav-item">
      <a class="nav-link" href="{% url 'login' %}">Login/Register</a>
  </li> -->
{% endif %}
                </ul>
                <!-- <p style="color:white; margin-top:15px; margin-left:20px; color:rgb(207,198,198);">
        {% if user.is_authenticated %}
             User: {{ user.username }}
        {% else %}
             User: Not logged in
        {% endif %}
    </p> -->

            </div>
           
        <!-- </div> -->
    </nav>
<div class="register-wrapper">
  <!-- LEFT SIDE -->
  <div class="register-left">
    <div class="left-overlay"></div>
    <div class="left-content">
      <span class="badge bg-light text-dark mb-2">Real Nest</span>
      <h5>Join the Best Property Platform</h5>
      <p>Sign up now and explore thousands of properties with ease.</p>
    </div>
  </div>

  <!-- RIGHT SIDE -->
  <div class="register-right">
    <h3 class="mt-2">Create Your Account</h3>
    <p class="text-muted mb-4">Sign up to get started</p>

    <!-- ✅ Show success or error messages -->
    

    <form id="registerForm" class="needs-validation" method="post" novalidate>

      {% csrf_token %}
    
       <div class="mb-3 position-relative">
  <span class="input-icon"><i class="bi bi-person"></i></span>
  <input 
      type="text" 
      name="full_name" 
      id="fullName" 
      class="form-control"
      placeholder="Full Name" 
      minlength="3" 
      pattern="^[A-Za-z\s]+$" 
      required>
  <div class="invalid-feedback" id="nameFeedback">
    ⚠️ Please enter only letters (min 3 characters, no numbers allowed).
  </div>
</div>


  <!-- Email -->
 <div class="mb-3 position-relative">
  <span class="input-icon"><i class="bi bi-envelope"></i></span>
  <input 
      type="email" 
      name="email" 
      id="email" 
      class="form-control"
      placeholder="Your Email"
      pattern="^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[A-Za-z]{2,}$"
      required>
  <div class="invalid-feedback" id="emailFeedback">
    ⚠️ Please enter a valid email address (e.g. user@example.com)
  </div>
</div>


  <!-- Phone -->
 <div class="mb-3 position-relative">
  <span class="input-icon"><i class="bi bi-telephone"></i></span>
  <input 
      type="tel" 
      name="phone" 
      id="phone" 
      class="form-control"
      placeholder="Phone Number"
      pattern="^[0-9]{10}$"
      required>
  <div class="invalid-feedback" id="phoneFeedback">
    ⚠️ Please enter a valid 10-digit phone number.
  </div>
</div>


  <!-- Password -->
  <div class="mb-3 position-relative">
    <span class="input-icon"><i class="bi bi-lock"></i></span>
    <input type="password" name="password1" id="password1" class="form-control"
           placeholder="Password" minlength="6" required>
    <span class="eye-icon" id="togglePass"><i class="bi bi-eye"></i></span>
    <div class="invalid-feedback">⚠️ Password must be at least 6 characters long.</div>
  </div>

  <!-- Confirm Password -->
  <div class="mb-3 position-relative">
    <span class="input-icon"><i class="bi bi-lock-fill"></i></span>
    <input type="password" name="password2" id="password2" class="form-control"
           placeholder="Confirm Password" required>
    <div class="invalid-feedback" id="confirmFeedback">⚠️ Passwords do not match.</div>
  </div>

      <button class="btn btn-success w-100 btn-register" type="submit">Register</button>
      {% if success %}
            <p class="text-success mt-3">{{ success }}</p>
          {% endif %}
 
          {% if error %}
            <p class="text-danger mt-2">{{ error }}</p>
          {% endif %}

      <div class="text-center mt-3 small-link">
        Already have an account? <a href="{% url 'login' %}">Login</a>
      </div>

    </form>

  </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<!-- Custom JS -->
<script src="{% static 'js/login.js' %}"></script>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const form = document.getElementById("registerForm");
  const password1 = document.getElementById("password1");
  const password2 = document.getElementById("password2");
  const phone = document.getElementById("phone");

  // Toggle Password Visibility
  document.getElementById("togglePass").addEventListener("click", () => {
    const type = password1.type === "password" ? "text" : "password";
    password1.type = type;
    password2.type = type;
  });

  // Form Submit Validation
  form.addEventListener("submit", (event) => {
    let valid = true;

    // Bootstrap built-in validation
    if (!form.checkValidity()) {
      valid = false;
    }

    // Custom: Match Passwords
    if (password1.value !== password2.value) {
      valid = false;
      password2.setCustomValidity("Passwords do not match");
      document.getElementById("confirmFeedback").style.display = "block";
    } else {
      password2.setCustomValidity("");
    }

    // Custom: Validate 10-digit phone
    const phonePattern = /^[0-9]{10}$/;
    if (!phonePattern.test(phone.value)) {
      valid = false;
      phone.setCustomValidity("Invalid phone");
    } else {
      phone.setCustomValidity("");
    }

    if (!valid) {
      event.preventDefault();           // Stop form submission
      event.stopPropagation();
    }

    form.classList.add("was-validated"); // Show Bootstrap feedback
  });
});
</script>
<!-- user name -->
<script>
document.addEventListener("DOMContentLoaded", () => {
  const fullName = document.getElementById("fullName");
  const feedback = document.getElementById("nameFeedback");

  fullName.addEventListener("input", () => {
    const regex = /^[A-Za-z\s]+$/;  // letters + spaces only
    if (!regex.test(fullName.value)) {
      fullName.setCustomValidity("Invalid");
      feedback.textContent = "⚠️ Only letters are allowed, no numbers or symbols.";
      feedback.style.display = "block";
    } else if (fullName.value.length < 3) {
      fullName.setCustomValidity("Too Short");
      feedback.textContent = "⚠️ Full name must be at least 3 characters long.";
      feedback.style.display = "block";
    } else {
      fullName.setCustomValidity("");  // Valid
      feedback.style.display = "none";
    }
  });
});
</script>
<!-- email address -->
 <script>
document.addEventListener("DOMContentLoaded", () => {
  const email = document.getElementById("email");
  const feedback = document.getElementById("emailFeedback");

  email.addEventListener("input", () => {
    const regex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[A-Za-z]{2,}$/;

    if (!regex.test(email.value)) {
      email.setCustomValidity("Invalid Email");
      feedback.textContent = "⚠️ Please enter a valid email address (e.g. user@example.com)";
      feedback.style.display = "block";
    } else {
      email.setCustomValidity(""); // ✅ Valid email
      feedback.style.display = "none";
    }
  });
});
</script>

<!-- contact number -->
 <script>
document.addEventListener("DOMContentLoaded", () => {
  const phone = document.getElementById("phone");
  const feedback = document.getElementById("phoneFeedback");

  phone.addEventListener("input", () => {
    const value = phone.value.trim();

    // ✅ Check if input is ONLY 10 digits
    if (/^\d{10}$/.test(value)) {
      phone.setCustomValidity("");          // Valid
      feedback.style.display = "none";
    } else {
      phone.setCustomValidity("Invalid");   // Invalid
      feedback.textContent = "⚠️ Phone number must be exactly 10 digits.";
      feedback.style.display = "block";
    }
  });
});
</script>



</body>
</html>
